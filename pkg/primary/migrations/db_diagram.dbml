// Sandpiper database diagram
// https://www.dbml.org/
// https://dbdiagram.io/

Table settings  [headercolor: #8e44ad] {
  id integer [pk, increment]
  key string [unique, not null]
  value string
}

Table users {
  id int [pk]
  name string
  email string
  password string
  company_id uuid [ref: > companies.id]
}

Table companies {
  id uuid [pk]
  name string
  contact string
  email string
  status statustype
}

Table subscriptions  [headercolor: #8e44ad] {
  id uuid [pk]
  slice_id uuid [ref: > slices.id]
  company_id uuid [ref: > companies.id]
  name string
  description string
  active boolean
}

Table tags  [headercolor: #16a085] {
  id int [pk]
  name string
  description string
}

Table slice_tags  [headercolor: #16a085] {
  tag_id int [pk, ref: > tags.id]
  slice_id uuid [pk, ref: > slices.id]
}

Table slices {
  id uuid [pk]
  name varchar
  slice_type slicetype_enum
  content_hash string [note: 'code representing all slice ids']
  content_count integer
  content_date datetime [note: 'when data in slice was updated']
}

Table slice_metadata {
  slice_id uuid [pk, ref: > slices.id]
  key string [pk]
  value string
}

Table grains {
  id uuid [pk]
  slice_id uuid [ref: > slices.id]
  grain_key string
  payload string
  source string
}

Enum statustype {
  active
  inactive
}

Enum slicetype_enum {
  "aces-file"        // level 1
  "pies-file"        // level 1
  "partspro-file"    // level 1
  "aces-item"
  "pies-item"
  "pies-marketcopy"
  "pies-pricesheet"
  "partspro-item"
}
